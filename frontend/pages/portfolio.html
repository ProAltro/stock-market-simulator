<!-- Portfolio Page -->
<div x-show="currentPage === 'portfolio'" class="page portfolio-page">
  <header class="page-header">
    <h1>Portfolio</h1>
  </header>

  <div class="portfolio-summary">
    <div class="stat-card large primary">
      <span class="stat-label">Net Worth</span>
      <span
        class="stat-value big"
        x-text="fmtBase(portfolio?.totalValue || 0)"
      ></span>
      <div class="stat-details">
        <span x-text="'Starting: ' + fmtBase(100000)"></span>
        <span
          :class="{ positive: portfolio?.totalReturn >= 0, negative: portfolio?.totalReturn < 0 }"
        >
          P&L:
          <span
            x-text="(portfolio?.totalReturn >= 0 ? '+' : '') + fmtBase(portfolio?.totalReturn || 0)"
          ></span>
        </span>
      </div>
    </div>
  </div>

  <section class="card">
    <h2>Holdings</h2>
    <div class="table-scroll">
      <table class="data-table" x-show="portfolio?.positions?.length > 0">
        <thead>
          <tr>
            <th>Symbol</th>
            <th>Quantity</th>
            <th>Avg Price</th>
            <th>Current</th>
            <th>Market Value</th>
            <th>P&L</th>
            <th>% Change</th>
          </tr>
        </thead>
        <tbody>
          <template x-for="pos in portfolio?.positions" :key="pos.id">
            <tr>
              <td>
                <strong x-text="pos.instrument?.symbol || pos.symbol"></strong>
                <small
                  style="opacity: 0.5; margin-left: 4px; font-size: 0.7em"
                  x-text="pos.currency"
                ></small>
              </td>
              <td x-text="pos.quantity"></td>
              <td
                x-text="fmtPos(pos.avgPrice, pos.avgPriceBase, pos.currency)"
              ></td>
              <td
                x-text="fmtPos(pos.currentPrice, pos.currentPriceBase, pos.currency)"
              ></td>
              <td
                x-text="fmtPos(pos.marketValue, pos.marketValueBase, pos.currency)"
              ></td>
              <td
                :class="{ positive: pos.unrealizedPnLBase >= 0, negative: pos.unrealizedPnLBase < 0 }"
                x-text="(pos.unrealizedPnLBase >= 0 ? '+' : '') + fmtBase(pos.unrealizedPnLBase)"
              ></td>
              <td
                :class="{ positive: pos.unrealizedPnLPercent >= 0, negative: pos.unrealizedPnLPercent < 0 }"
                x-text="formatPercent(pos.unrealizedPnLPercent)"
              ></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <p x-show="!portfolio?.positions?.length" class="empty-state">
      No holdings yet. Start trading to build your portfolio!
    </p>
  </section>
</div>
