[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/run/supervisord.pid

[program:market_sim]
command=/app/market_sim/market_sim --populate 100 --export-on-start --data-dir /data --auto-start
directory=/app
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/market_sim.log
stderr_logfile=/var/log/supervisor/market_sim_err.log
priority=40

[program:backend]
command=/usr/bin/node /app/backend/src/app.js
directory=/app/backend
environment=NODE_ENV="production",DATABASE_URL="postgresql://decrypt:decrypt123@postgres:5432/decrypt?schema=public",REDIS_URL="redis://localhost:6379",MARKET_SIM_URL="http://localhost:8080",DATA_DIR="/data"
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/backend.log
stderr_logfile=/var/log/supervisor/backend_err.log
priority=50

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/var/log/supervisor/nginx.log
stderr_logfile=/var/log/supervisor/nginx_err.log
priority=60
